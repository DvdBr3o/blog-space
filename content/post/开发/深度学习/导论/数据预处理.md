---
title: 数据预处理
date: 2025-07-14T18:49:30+08:00
lastmod: 2025-08-09T00:39:01+08:00
tags:
  - 深度学习
  - ai
categories: 深度学习
publish: true
---

## 输入

### CSV

```python
import os
import panda as pd

data = pd.read_csv(os.path.join('path', 'to', 'data.csv'))
```

## 预处理

`iloc`: 数据截取
```python
import os
import panda as pd

data = pd.read_csv(os.path.join('path', 'to', 'data.csv'))
print(data)
#    NumRooms Alley   Price
# 0       NaN  Pave  127500
# 1       2.0   NaN  106000
# 2       4.0   NaN  178100
# 3       NaN   NaN  140000

inputs, outputs = data.iloc[:, :2], data.iloc[:, 2]
print(inputs)
#    NumRooms Alley
# 0       NaN  Pave
# 1       2.0   NaN
# 2       4.0   NaN
# 3       NaN   NaN

print(outputs)
# 0    127500
# 1    106000
# 2    178100
# 3    140000
```

`fillna`: 把空值 `NA` 用指定值填充
```python
inputs = inputs.fillna(inputs.mean()) # 用均值填充空值
```

`get_dummies`: 进行 [one-hot 编码](../%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/one-hot%20%E7%BC%96%E7%A0%81.md)
```python
inputs = pd.get_dummies(inputs, dummy_na=True)
print(inputs)
#    NumRooms  Alley_Pave  Alley_nan
# 0       3.0           1          0
# 1       2.0           0          1
# 2       4.0           0          1
# 3       3.0           0          1
```
如果 `Alley` 有其他值比如 `Bave`，则会多一列 `Alley_Bave` 只在值为 `Bave` 的行为 `1`

>[!note] Why one-hot?
>模型通常用 类型值 の差作为两个类别的差距
>一般类别之间差距是两两等距的，而 label 编码不符合该特征，one-hot 编码符合

`get_numpy`: 转为张量
```python
import torch

x = torch.tensor(inputs.to_numpy(dtype=float))
```

