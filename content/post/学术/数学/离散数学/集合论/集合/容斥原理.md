---
title: 容斥原理
date: 2025-08-16T11:37:08+08:00
lastmod: 2025-11-24T17:29:07+08:00
tags:
  - 离散数学
  - 集合
categories: 离散数学
publish: true
---

已知
- $S$ 为全集
- $A_{k}$ 为具有性质的 $P_{k}$ 的集合

则容斥原理

$$
\left| \bar{A}_{1} \cap \bar{A}_{2} \cap \dots \cap \bar{A}_{n} \right| = \left| S \right| -\sum_{i}\left| A_{i} \right| + \sum_{i\neq j}\left| A_{i}\cap A_{j} \right|-\dots+(-1)^{n}\left| A_{1}\cap A_{2}\cap\dots \cap A_{n} \right|    
$$

>[!example] 应用
>可以用容斥原理解决全错排问题
>记 $A_{k}$ 为第 $k$ 个人正确排列
>则
>- $\left| A_{i} \right|=(n-1)!$
>- $\left| A_{i} \cap A_{j} \right|=(n-2)!$
>- $\left| A_{i}\cap A_{j}\cap A_{k} \right|=(n-3)!$
>- $\dots$
>
>全错排方案数为
>
> $$
> \begin{align}
> \left| \bar{A}_{1} \cap \bar{A}_{2} \cap \dots \cap \bar{A}_{n} \right|  & = n! - C_{n}^{1}\cdot(n-1)!+C_{n}^{2}\cdot(n-2)!-\dots \\
>  & =n!\cdot \left[ 1-\frac{1}{1!}+\frac{1}{2!}-\dots+(-1)^{n} \frac{1}{n!} \right] 
> \end{align}
> $$

>[!hint] 关键思想
>通常运用**逆向思维**，构造违反作为性质 $A_{i}$，然后对 $\left|\bigcup A_{i}\right|$ 做容斥
>e.g. [k-排列](../../%E7%BB%84%E5%90%88%E8%AE%A1%E6%95%B0/k-%E6%8E%92%E5%88%97.md) & [k-组合](../../%E7%BB%84%E5%90%88%E8%AE%A1%E6%95%B0/k-%E7%BB%84%E5%90%88.md)